<!DOCTYPE html>
<html>
<head>
    <title>Apple Maps Route</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <script src="https://cdn.apple-mapkit.com/mk/5.x.x/mapkit.js"></script>
    <script>
        // MapKit JS initialisieren
        mapkit.init({
            authorizationCallback: function(done) {
                // FÃ¼ge hier deinen MapKit JS Token ein
                done("eyJraWQiOiJCSEhSOU1GTUQ5IiwidHlwIjoiSldUIiwiYWxnIjoiRVMyNTYifQ.eyJpc3MiOiJUR004M1FTSEFIIiwiaWF0IjoxNzM2MTkxNjYzLCJvcmlnaW4iOiJieXNhbTA0LmdpdGh1Yi5pbyJ9.bpyf2c4JWOK9JQGPZsbeIURgR9kRTTbRuxwcN24a0uzQxK-RbQ98OTwini0UJdYVLR8Wscr1tiveZvwoJKpmKg");
            }
        });

        function showRoute() {
            // URL-Parameter auslesen
            const urlParams = new URLSearchParams(window.location.search);
            const start = urlParams.get('start'); // Startkoordinaten (z. B. "47.3769,8.5417")
            const end = urlParams.get('end');     // Zielkoordinaten (z. B. "46.9481,7.4474")

            if (!start || !end) {
                alert("Bitte Start- und Zielkoordinaten in der URL angeben, z. B.: ?start=47.3769,8.5417&end=46.9481,7.4474");
                return;
            }

            // Koordinaten erstellen
            let startCoord = new mapkit.Coordinate(...start.split(',').map(Number));
            let endCoord = new mapkit.Coordinate(...end.split(',').map(Number));

            // Karte erstellen
            let map = new mapkit.Map("map", {
                showsCompass: mapkit.FeatureVisibility.Visible,
                showsScale: mapkit.FeatureVisibility.Visible,
                center: startCoord, // Zentrum initial auf den Startpunkt setzen
                region: new mapkit.CoordinateRegion(
                    startCoord,
                    new mapkit.CoordinateSpan(0.5, 0.5)
                )
            });

            // Route berechnen
            let directions = new mapkit.Directions();
            directions.route(
                {
                    origin: startCoord,
                    destination: endCoord
                },
                (error, data) => {
                    if (error) {
                        console.error("Fehler bei der Routenberechnung:", error);
                        alert("Fehler bei der Routenberechnung: " + error);
                        return;
                    }

                    // Route auf der Karte anzeigen
                    let route = data.routes[0];
                    let routePolyline = new mapkit.PolylineOverlay(route.path, {
                        style: new mapkit.Style({
                            lineWidth: 5,
                            strokeColor: "#007aff",
                            strokeOpacity: 0.8
                        })
                    });

                    map.addOverlay(routePolyline);

                    // Karte auf die gesamte Route zoomen
                    map.showItems([routePolyline]);
                }
            );
        }
    </script>
</head>
<body onload="showRoute()">
    <h1>Apple Maps Route</h1>
    <div id="map" style="width: 100%; height: 600px; border: 1px solid #ccc;"></div>
</body>
</html>
